<!-- Page Content -->
<div class="content container-fluid">

    <!-- Page Header -->
    <div class="page-header">
      <div class="row align-items-center">
        <div class="col">
          <h3 class="page-title">Payroll Dashboard</h3>
          <ul class="breadcrumb">
            <li class="breadcrumb-item"><a [routerLink] = "routes.adminDashboard">Dashboard</a></li>
            <li class="breadcrumb-item active">Payroll Dashboard</li>
          </ul>
        </div>
      </div>
    </div>
    <!-- /Page Header -->
  
    <!-- Page Tab -->
    <div class="page-menu">
<div class="container">
     
  
    <!-- Quick Access Links -->
    <div class="row mb-3">
      <div class="col-md-4">
        <button class="btn btn-primary w-100"  [ngClass]="{ active: activeTab === 'dashboard' }" (click)="setActiveTab('dashboard')">Process Payroll</button>
      </div>
      <div class="col-md-4">
        <button class="btn btn-secondary w-100" [ngClass]="{ active: activeTab === 'configuration' }" (click)="setActiveTab('configuration')">Configure Payroll Settings</button>
      </div>
      <div class="col-md-4">
        <button class="btn btn-info w-100" [ngClass]="{ active: activeTab === 'view' }" (click)="setActiveTab('view')">View Reports</button>
      </div>
    </div>
   <!-- Tab Content -->
   <div class="tab-content mt-3">
    <!-- Dashboard Tab -->
    <div *ngIf="activeTab === 'dashboard'">
       <!-- Payroll Metrics -->
    <div class="row mb-3">
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Total Payroll</h5>
              <p class="card-text">{{ calculateTotalPayroll() | currency }}</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Upcoming Payroll</h5>
              <p class="card-text">{{ getUpcomingPayroll() | date: 'short' }}</p>
            </div>
          </div>
        </div>
      </div>
    
      <!-- Add Payroll Button -->
      <button class="btn btn-primary mb-3" (click)="openModal('add')">Add Payroll</button>
    
      <!-- Payroll Table -->
      <div class="table-responsive table-newdatatable">
        <table class="table table-new custom-table mb-0 datatable">
        <thead>
          <tr>
            <th>Total Payroll</th>
            <th>Payroll Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let payroll of payrolls">
            <td>{{ payroll.totalPayroll | currency }}</td>
            <td>{{ payroll.payrollDate | date: 'short' }}</td>
            <td>{{ payroll.status }}</td>
            <td>
                <div class="dropdown dropdown-action">
                    <a class="action-icon dropdown-toggle" data-bs-toggle="dropdown"
                        aria-expanded="false">
                        <i class="material-icons">more_vert</i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a (click)="openModal('edit', payroll)" class="dropdown-item"
                            >
                            <i class="fa-solid fa-pencil m-r-5"></i> Edit
                        </a>
                        <a (click)="deletePayroll(payroll.id)" class="dropdown-item"
                        data-bs-toggle="modal" data-bs-target="#delete_document">
                        <i class="fa-regular fa-trash-can m-r-5"></i>  Delete
                    </a>
                    </div>
                </div>
            </td>
            
          </tr>
        </tbody>
      </table>
    </div>
      <!-- Add/Edit Payroll Modal -->
      <div class="modal" tabindex="-1" [ngClass]="{ 'show': showModal }" style="display: block;" *ngIf="showModal">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">{{ isEditMode ? 'Edit Payroll' : 'Add Payroll' }}</h5>
              <button type="button" class="btn-close" (click)="closeModal()"></button>
            </div>
            <div class="modal-body">
              <form [formGroup]="payrollForm" (ngSubmit)="isEditMode ? updatePayroll() : addPayroll()">
                <div class="mb-3">
                  <label for="totalPayroll" class="form-label">Total Payroll</label>
                  <input type="number" formControlName="payrollForm.get('totalPayroll')" class="form-control" id="totalPayroll" />
                  <div *ngIf="payrollForm.get('totalPayroll')?.invalid && payrollForm.get('totalPayroll')?.touched">
                    <small class="text-danger">Total Payroll is required.</small>
                  </div>
                </div>
    
                <div class="mb-3">
                  <label for="payrollDate" class="form-label">Payroll Date</label>
                  <input type="date" formControlName="payrollForm.get('payrollDate')" class="form-control" id="payrollDate" />
                  <div *ngIf="payrollForm.get('payrollDate')?.invalid && payrollForm.get('payrollDate')?.touched">
                    <small class="text-danger">Payroll Date is required.</small>
                  </div>
                </div>
    
                <button type="submit" class="btn btn-primary">
                  {{ isEditMode ? 'Update' : 'Add' }}
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    </div>

    <!-- Payroll Configuration Tab -->
    <div *ngIf="activeTab === 'configuration'">
      <!-- Payroll Configuration Form -->
<div class="container">
    <h3>Payroll Configuration</h3>
  
    <form [formGroup]="payrollConfigForm" (ngSubmit)="saveConfig()">
      <div class="mb-3">
        <label for="payPeriod" class="form-label">Pay Period</label>
        <select formControlName="payPeriod" id="payPeriod" class="form-control">
          <option value="monthly">Monthly</option>
          <option value="bi-weekly">Bi-Weekly</option>
          <option value="weekly">Weekly</option>
        </select>
      </div>
  
      <div class="mb-3">
        <label for="taxRules" class="form-label">Tax Rules</label>
        <textarea formControlName="taxRules" id="taxRules" class="form-control"></textarea>
      </div>
  
      <div class="mb-3">
        <label for="benefits" class="form-label">Benefits</label>
        <input type="text" formControlName="benefits" id="benefits" class="form-control" />
      </div>
  
      <button type="submit" class="btn btn-primary">Save Configuration</button>
    </form>
  </div>
  
    </div>

    <!-- Payroll View Tab -->
    <div *ngIf="activeTab === 'view'">
     <!-- Payroll View -->
<div class="container">
    <h3>Payroll Records</h3>
  
    <!-- Filters and Sorting -->
    <div class="row mb-3">
      <div class="col-md-4">
        <label for="filterStatus" class="form-label">Filter by Status</label>
        <select class="form-control" id="filterStatus" [(ngModel)]="filterStatus" (change)="applyFilter()">
          <option value="">All</option>
          <option value="pending">Pending</option>
          <option value="processed">Processed</option>
        </select>
      </div>
    </div>
  
    <!-- Payroll Table -->
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Total Payroll</th>
          <th>Payroll Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let payroll of filteredPayrolls">
          <td>{{ payroll.totalPayroll | currency }}</td>
          <td>{{ payroll.payrollDate | date: 'short' }}</td>
          <td>{{ payroll.status }}</td>
          <td>
            <button class="btn btn-info">View Report</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
    </div>
  </div>
  </div>
  